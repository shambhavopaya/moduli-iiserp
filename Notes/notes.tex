\documentclass[11pt]{amsart}
\usepackage[margin=1.2in,marginparsep=0.2in,marginparwidth=1in]{geometry}
\geometry{asymmetric}
\usepackage{amssymb,amsmath,amsthm,amstext,amscd,latexsym,graphics,graphicx,bbm,caption}
\usepackage{marginnote}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage[plainpages=false,colorlinks=true, linkcolor=blue, citecolor=red, pagebackref]{hyperref}
\usepackage{enumitem}
\usepackage{tikz-cd}
\usepackage{verbatim}
\usepackage{perpage}
\MakePerPage{footnote}

\makeatletter
\renewcommand\section{\@startsection {section}{1}{\z@}%
	{-3.5ex \@plus -1ex \@minus -.2ex}%
	{2.3ex \@plus.2ex}%
	{\normalfont\scshape\center}}
\makeatother

\makeatletter
\renewcommand\subsection{\@startsection {subsection}{1}{\z@}%
	{-2ex \@plus -1ex \@minus -.2ex}%
	{.5ex \@plus.2ex}%
	{\normalfont\bfseries}}
\makeatother


\makeatletter
\def\@settitle{\begin{center}%
		\baselineskip14\p@\relax
		\bfseries
		\uppercasenonmath\@title
		\@title
		\ifx\@subtitle\@empty\else
		\\[1ex]\uppercasenonmath\@subtitle
		\footnotesize\mdseries\@subtitle
		\fi
	\end{center}%
}
\def\subtitle#1{\gdef\@subtitle{#1}}
\def\@subtitle{}
\makeatother
%
%
\makeatletter
\long\def\@mn@@@marginnote[#1]#2[#3]{%
	\begingroup
	\ifmmode\mn@strut\let\@tempa\mn@vadjust\else
	\if@inlabel\leavevmode\fi
	\ifhmode\mn@strut\let\@tempa\mn@vadjust\else\let\@tempa\mn@vlap\fi
	\fi
	\@tempa{%
		\vbox to\z@{%
			\vss
			\@mn@margintest
			\if@reversemargin\if@tempswa
			\@tempswafalse
			\else
			\@tempswatrue
			\fi\fi
			
			\llap{%
				\vbox to\z@{\kern\marginnotevadjust\kern #3
					\vbox to\z@{%
						\hsize\marginparwidth
						\linewidth\hsize
						\kern-\parskip
						%\mn@parboxrestore
						\marginfont\raggedleftmarginnote\strut\hspace{\z@}%
						\ignorespaces#1\endgraf
						\vss
					}%
					\vss
				}%
				\if@mn@verbose
				\PackageInfo{marginnote}{xpos seems to be \@mn@currxpos}%
				\fi
				\begingroup
				\ifx\@mn@currxpos\relax\else\ifx\@mn@currpos\@empty\else
				\kern\@mn@currxpos
				\fi\fi
				\ifx\@mn@currpage\relax
				\let\@mn@currpage\@ne
				\fi
				\if@twoside\ifodd\@mn@currpage\relax
				\kern-\oddsidemargin
				\else
				\kern-\evensidemargin
				\fi
				\else
				\kern-\oddsidemargin
				\fi
				\kern-1in
				\endgroup
				\kern\marginparsep
			}%
		}%
	}%
	\endgroup
}
\makeatother
%

%% LaTeX Definitions
%\newcounter{countup}

\newcommand{\rup}[1]{\lceil{#1}\rceil}
\newcommand{\rdown}[1]{\lfloor{#1}\rfloor}
\newcommand{\ilim}{\mathop{\varprojlim}\limits} % inverse limit
\newcommand{\dlim}{\mathop{\varinjlim}\limits}  % direct limit
\newcommand{\surj}{\twoheadrightarrow}
\newcommand{\inj}{\hookrightarrow}
\newcommand{\tensor}{\otimes}
\newcommand{\ext}{\bigwedge}
\newcommand{\Intersection}{\bigcap}
\newcommand{\Union}{\bigcup}
\newcommand{\intersection}{\cap}
\newcommand{\union}{\cup}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% new new commands :) %%%%%%%%%%%%%%%%
\newcommand{\supp}{{\rm Supp}}
\newcommand{\Exceptional}{{\rm Ex}}
\newcommand{\del}{\partial}
\newcommand{\delbar}{\overline{\partial}}
\newcommand{\boldphi}{\mbox{\boldmath $\phi$}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\udiv}{\underline{\Div}}

%%%%%%%%%%%%%%%%%

\newcommand{\Proj}{{\P roj}}
\newcommand{\sEnd}{{\sE nd}}
\newcommand{\mc}{\mathcal}
\newcommand{\mb}{\mathbb}
\newcommand{\an}{{\rm an}} 
\newcommand{\red}{{\rm red}}
\newcommand{\codim}{{\rm codim}}
\newcommand{\Dim}{{\rm dim}}
\newcommand{\rank}{{\rm rank}}
\newcommand{\Ker}{{\rm Ker  }}
\newcommand{\Pic}{{\rm Pic}}
\newcommand{\per}{{\rm per}}
\newcommand{\ind}{{\rm ind}}
\newcommand{\Div}{{\rm Div}}
\newcommand{\Hom}{{\rm Hom}}
\newcommand{\Aut}{{\rm Aut}}
\newcommand{\im}{{\rm im}}
\newcommand{\Spec}{{\rm Spec \,}}
\newcommand{\Sing}{{\rm Sing}}
\newcommand{\sing}{{\rm sing}}
\newcommand{\reg}{{\rm reg}}
\newcommand{\Char}{{\rm char}}
\newcommand{\Tr}{{\rm Tr}}
\newcommand{\Gal}{{\rm Gal}}
\newcommand{\Min}{{\rm Min \ }}
\newcommand{\Max}{{\rm Max \ }}
\newcommand{\Alb}{{\rm Alb}\,}
\newcommand{\Mat}{{\rm Mat}}
%\newcommand{\GL}{{\rm GL}\,}        % For the general linear group
\newcommand{\GL}{{\G\L}}
\newcommand{\Ho}{{\rm Ho}}
\newcommand{\ie}{{\it i.e.\/},\ }
\renewcommand{\iff}{\mbox{ $\Longleftrightarrow$ }}
\renewcommand{\tilde}{\widetilde}
% Skriptbuchstaben
\newcommand{\sA}{{\mathcal A}}
\newcommand{\sB}{{\mathcal B}}
\newcommand{\sC}{{\mathcal C}}
\newcommand{\sD}{{\mathcal D}}
\newcommand{\sE}{{\mathcal E}}
\newcommand{\sF}{{\mathcal F}}
\newcommand{\sG}{{\mathcal G}}
\newcommand{\sH}{{\mathcal H}}
\newcommand{\sI}{{\mathcal I}}
\newcommand{\sJ}{{\mathcal J}}
\newcommand{\sK}{{\mathcal K}}
\newcommand{\sL}{{\mathcal L}}
\newcommand{\sM}{{\mathcal M}}
\newcommand{\sN}{{\mathcal N}}
\newcommand{\sO}{{\mathcal O}}
\newcommand{\sP}{{\mathcal P}}
\newcommand{\sQ}{{\mathcal Q}}
\newcommand{\sR}{{\mathcal R}}
\newcommand{\sS}{{\mathcal S}}
\newcommand{\sT}{{\mathcal T}}
\newcommand{\sU}{{\mathcal U}}
\newcommand{\sV}{{\mathcal V}}
\newcommand{\sW}{{\mathcal W}}
\newcommand{\sX}{{\mathcal X}}
\newcommand{\sY}{{\mathcal Y}}
\newcommand{\sZ}{{\mathcal Z}}
% Sonderbuchstaben mit Doppellinie
\newcommand{\A}{{\mathbb A}}
\newcommand{\B}{{\mathbb B}}
\newcommand{\C}{{\mathbb C}}
\newcommand{\D}{{\mathbb D}}
\newcommand{\E}{{\mathbb E}}
\newcommand{\F}{{\mathbb F}}
\newcommand{\G}{{\mathbb G}}
\newcommand{\HH}{{\mathbb H}}
\newcommand{\I}{{\mathbb I}}
\newcommand{\J}{{\mathbb J}}
\newcommand{\M}{{\mathbb M}}
\newcommand{\N}{{\mathbb N}}
\renewcommand{\O}{{\mathbb O}}
\renewcommand{\P}{{\mathbb P}}
\newcommand{\Q}{{\mathbb Q}}
\newcommand{\R}{{\mathbb R}}
\newcommand{\T}{{\mathbb T}}
\newcommand{\U}{{\mathbb U}}
\newcommand{\V}{{\mathbb V}}
\newcommand{\W}{{\mathbb W}}
\newcommand{\X}{{\mathbb X}}
\newcommand{\Y}{{\mathbb Y}}
\newcommand{\Z}{{\mathbb Z}}
\newcommand{\Sh}{\sS h}
\newcommand{\deltaop}{\Delta^{op}(\sS h(Sm/\mathbf{k}))}
\newcommand{\pdeltaop}{\Delta^{op}(P\sS h(Sm/\mathbf{k}))}
%\newcommand{\psh}{\pi_0^{\text{\tiny pre}}}
\newcommand{\psh}{\pi_0}
\renewcommand{\k}{\mathbf{k}}

\newcommand{\colim}{{\rm colim \,}}
\newcommand{\DM}[2]{\mathbf{DM}_{#2}^{\mathit{eff}}(#1)}
\newcommand{\Ob}{\text{Ob}}


\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{question}[theorem]{Question}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}


\begin{document}
% Document information
\title{Seminar on Moduli Theory}
\subtitle{\today}
\author{Neeraj Deshmukh}
%\date{\today}
%\address[IISERM]{Indian Institute of Science Education and Research, Mohali}

\maketitle


These are notes for the first few lectures. The aim is to gather sufficient algebraic geometry background for discussing moduli theory. A lot of the \LaTeX\, code in this document has been shamelessly copied from the stacks project repository on GitHub\footnote{Thank you Aise Johan de Jong \textit{et al.} for TeX-ing all that math!}.

\begin{comment}
\section{Plan}

One way to go to through these sessions is go recall theory of schemes (at level of things in Hartshorne chapter two), by doing a beeline through all the definitions, properties, etc. However, I feel since the point of doing this exercise is to become more comfortable in working with scheme, we will just do lots of examples instead. By this, I mean we will just to prove some things in very concrete situations. This will help you build a concrete picture of the generalities.

List of some things to discuss (just do lots of examples):

\begin{enumerate}
	\item Definition of a scheme.
	\item Say affine communication lemma \textit{stress this!}
	\item examples
	\begin{enumerate}
		\item $\P^n$ and it sheaf theory! This already clarifies the $\sO(n)$'s
	\end{enumerate}
\end{enumerate}


Things to say: finite-generation, valuative criteria for $\P^1$ (using DVR's - how giving a point and its specialisation is the same as giving a map $\Spec R\rightarrow \P^1$).\\
List of examples:
\begin{enumerate}
	\item $\A^1$ with a double point (what are quasi-coherent sheaves on this?)
	\item $\A^2\setminus \lbrace 0,0\rbrace$ (what is the structure sheaf?).
	\item $\P^1$ (its structure sheaf!).
	\item $V_{+}(x^2+y^2+z^2)$ over $\R$ and $\C$. The point is that there is a change of coordintes which 
	\item Blow-up of $\A^2$ at a point. (because everyone should know about blow-ups!)
	\item $\Spec R[x_1,x_2,\ldots]$ as an example of something non-noetherian.
	\item An example of a scheme without a closed point.
\end{enumerate}

List of morphisms:
\begin{enumerate}
	\item $x\mapsto x^2$ (more, generally $x^n$). This covers ramified, finitely presented, flat.
	\item a non-quasi-compact open-immersion. Polynomial ring in infinitely many variables and knock off the origin. Also, the origin of is an example of something 
\end{enumerate}
\end{comment}

\section{Schemes}
For the sake of completeness we begin by reviewing the definition of a locally ringed space.

\begin{definition}
	\label{definition-locally-ringed-space}\marginnote{0000}
	Locally ringed spaces.
	\begin{enumerate}
		\item A {\it locally ringed space $(X, \mathcal{O}_X)$}
		is a pair consisting of a
		topological space $X$ and a sheaf of rings $\mathcal{O}_X$ all of whose stalks
		are local rings.
		\item Given a locally ringed space $(X, \mathcal{O}_X)$ we say that
		$\mathcal{O}_{X, x}$ is the {\it local ring of $X$ at $x$}.
		We denote $\mathfrak{m}_{X, x}$ or simply $\mathfrak{m}_x$
		the maximal ideal of $\mathcal{O}_{X, x}$. Moreover, the
		{\it residue field of $X$ at $x$} is the residue field
		$\kappa(x) = \mathcal{O}_{X, x}/\mathfrak{m}_x$.
		\item A {\it morphism of locally ringed spaces}
		$(f, f^\sharp) : (X, \mathcal{O}_X) \to (Y, \mathcal{O}_Y)$
		is a morphism of ringed spaces such that for all $x \in X$
		the induced ring map $\mathcal{O}_{Y, f(x)} \to \mathcal{O}_{X, x}$ is a
		local ring map.
	\end{enumerate}
\end{definition}


We know that affine schemes are locally ringed spaces: we take $\Spec R$ with the zariski topology and for any principal open set $D(f)$ we assign the ring $R_f$. So, any ring $R$ produces the sheaf $\tilde{R}$ on $\Spec R$. This is called the tilde construction. (sanity check: if you can do this, then you should be able to construct a sheaf on $\Spec R$ for any $R$-module $M$).


\begin{definition}
	\label{definition-scheme}\marginnote{0001}
	A {\it scheme} is a locally ringed space with the property that
	every point has an open neighbourhood which is an affine scheme.
	A {\it morphism of schemes} is a morphism of locally
	ringed spaces. The category of schemes will be denoted
	$Sch$.
\end{definition}

\begin{definition}
	\label{definition-quasi-coherent-sheaf}\marginnote{0002}
	Let $(X,\mathcal{O}_X)$ be a scheme. A sheaf of modules on $X$ is a sheaf $\mathcal{F}$ on $X$ such that for every open set $U$, $\mathcal{F}(U)$ is an $\mathcal{O}_X(U)$-module. We say that a sheaf of modules $\mathcal{F}$ is \textit{quasi-coherent} if for every affine open $U\simeq \Spec(R)$, the sheaf $\mathcal{F}|_U$ on $U$ is of the form $\tilde{M}$ for some $R$-module $M$.
\end{definition}


Make special note of the next lemma. This basically lets us reduce problems about schemes to statement about affine schemes (ergo, ring theory), whenever the problem at hand is of a \textit{local} nature. Ravi Vakil calls this \textit{affine communication lemma}.

\begin{lemma}
	\label{lemma-locally-P}\marginnote{0003}
	Let $X$ be a scheme. Let $P$ be a local property of rings.
	The following are equivalent:
	\begin{enumerate}
		\item The scheme $X$ is locally $P$.
		\item For every affine open $U \subset X$ the property
		$P(\mathcal{O}_X(U))$ holds.
		\item There exists an affine open covering $X = \bigcup U_i$ such that
		each $\mathcal{O}_X(U_i)$ satisfies $P$.
		\item There exists an open covering $X = \bigcup X_j$
		such that each open subscheme $X_j$ is locally $P$.
	\end{enumerate}
	Moreover, if $X$ is locally $P$ then every open subscheme
	is locally $P$.
\end{lemma}

This is how commutative algebra meets geometry. Often, the properties that we want to consider are ``globalised" versions of statements about rings.\footnote{You can also ``globalise" morphisms of rings, but now you have two schemes to work locally on. We'll do this soon.}

\subsection{Two ways of Gluing \texorpdfstring{$\A^1\setminus \lbrace 0\rbrace$}{Pn}.}
\label{subsection-gluing-A1}\marginnote{0004}
Take two copies of $\A^1:= \Spec k[x]$\footnote{For simplicity, assume that $k$ is field, but this is not needed.}. Let $U:= \Spec k[x,1/x]$, be the complement of the origin in $\A^1$.

\begin{center}
\begin{tikzcd}
	\A^1 &	\A^1\\
	U\arrow[u, hook]\arrow{r}{\sim} & U\arrow[u, hook]\\
\end{tikzcd}
\end{center}

Giving this information is that same giving a scheme which is looks like $\A^1$ around every point (why?). We consider two possible choices for the identification on $U$:
\begin{align*}
x &\mapsto x\\
x &\mapsto 1/x
\end{align*}
\begin{example}\label{example-double-origin}\marginnote{0005}
 The first choice gives us a scheme which is like $\A^1$ everywhere except at the origin where it is now two points instead of one. Notice that the ring of global section of this scheme is $k[x]$ (a global section is same as giving polynomials $f, g\in k[x]$, one for each copy of $\A^1$ which are equal on $U$; conclude form this).
\end{example}

\begin{example}\label{example-projective-line}\marginnote{0006}
The second choice gives us the projective line $\P^1$. This is looks like $\A^1$ with ``a point added at infinity". We will now compute its global sections.

Let $f,g\in\A^1$ be two polynomials such that $f(x)=g(1/x)$ in $k[x,1/x]$. Then straightforward algebra shows that this can happen only when $f, g$ are constant, i.e, $\Gamma(\P^1,\sO_{\P^1})=k$.
\end{example}

\begin{example}[A DVR with double origin]
	\label{example-dvr-double-origin}\marginnote{0007}
Similar to $\A^1$ with double origin, we can glue two copies of a DVR. Let $R$ be a discrete valuation ring. Then $\Spec R$ has exactly two point: the generic point (zero ideal) and the closed point (maximal ideal). The generic point is open in $\Spec R$ and is given by $\Spec K$, where $K$ is quotient field of $R$. As for $\A^1$, the ring of global sections of a DVR with double origin is $R$.

Furthermore, to determine any coherent sheaf (a quasi-coherent sheaf which is a finitely generated module on each copy of $R$) it is sufficient to give a pair $(n,T)$ where $n$ is a positive integer and $T\in Gl_n(K)$. Since $R$ is a principal ideal domain, any finitely generated $R$-module $M$ is a direct sum of its free and torsion parts. Thus, if $M, N$ are two finitely generated $R$-modules,there exists an isomorphism (given by a $K$-linear map) $M\otimes K \simeq N\otimes K$ if and only if the rank of their free parts is the same. Of course, this description is not unique. However, if we restrict to locally free sheaves, then we have a correspondence between locally free sheaves on DVR with a double origin and pair $(n,T)$.
\end{example}

\begin{comment}
\begin{tikzcd}[remember picture]
	A \arrow[r] & B\\
	C \arrow[r] & D\\
\end{tikzcd}
\begin{tikzpicture}[overlay,remember picture]
\path (\tikzcdmatrixname-2-1) to node[midway,sloped]{$\subseteq$}
(\tikzcdmatrixname-1-1);
\path (\tikzcdmatrixname-2-2) to node[midway,sloped]{$\subseteq$}
(\tikzcdmatrixname-1-2);
\end{tikzpicture}
\end{comment}

\subsection{\texorpdfstring{$P$}{P} versus locally \texorpdfstring{$P$}{P}.}
\label{subsection-P-versus-locallyP}\marginnote{0008}
All the above are examples of locally normal (in fact, regular), locally reduced and locally Noetherian scheme\footnote{This is probably not standard notation, but instructive for the current discussion.}. For any property that is locally $P$ (as defined in \ref{lemma-locally-P}), the usual rule of thumb for nomenclature is $P=$ locally $P\,\,+$ quasi-compact: for example, a scheme is Noetherian if it is locally Noetherian and quasi-compact. Not all properties are of this type: for example quasi-compactness, sepratedness, properness, etc. We will come back to this when we discuss morphisms.



\subsection{Line Bundles on \texorpdfstring{$\P^1$}{P1}.}
\label{P1-line-bundles}\marginnote{0009}
 Locally on an affine open, this should be a free module of rank one. Let's contruct one such line bundle (non-trivial, of course): There are two open sets, $D(x)$ and $D(y)$, on these our line bundle looks like $k[x]$ and $k[y]$, respectively. Now, how do they glue on $k[x,1/x]\simeq k[y,1/y]$? Let's use the map which sends $\phi(1):f(x)\mapsto f(x)y$, since $y$ is $1/x$ in this ring, we see that the global sections are linear polynomials. You construct such a map $\phi(n)$ for every power of $y$. That will give you degree $n$ monomials. These line bundles are called $\sO(n)$'s. Playing around with the algebra of the maps $\phi(n)$ a little will that these line bundles satisfy relations like $\sO(n)\otimes\sO(m)\simeq \sO(m+n)$, and admit duals which are denote by $\sO(-n)$.\footnote{The line bundle $\sO(1)$ is important. To say that a variety is projective, we need to show that something like $\sO(1)$ lives on it. Actually, some lesser works, but we will come back to this later.}
[Discussed till here as of August 28, 2020]


\begin{example}[A slightly more involved scheme: \texorpdfstring{$\P^n$}{Pn}]\label{example-projective-space}\marginnote{000A}
Consider 
\[D(x_i):= \Spec k[x_{0/i},x_{1/i},\ldots,\ldots,x_{n/i}]/(x_{i/i}-1).\]
This is basically the same as $\A^n$, but we write it like this for reasons that will become evident soon. If we invert one of the variables, say $x_{j/i}$, we can write an isomorphism $D(x_i)_{x_{j/i}}\cong D(x_j)_{x_{i/j}}$ given by the maps 

\[\phi_{ij}:x_{k/i}\mapsto x_{k/j}/x_{i/j}\;\; \&\;\; \phi_{ji}:x_{k/j}\mapsto x_{k/i}/x_{j/i}\]
Now we just have to check that this agrees on triples. For this, you just have to check that $\phi_{ij}\circ\phi_{jk}=\phi_{ik}$ (what is the (co)domain of these maps?). Note that this construction doesn't really utilise the fact that $k$ is a field.
\end{example}

\subsection{A classical interlude.}\label{subsection-homogeneous-coordinates}\marginnote{000B}
Here's a classical definition of $\P^n$ in terms of \textit{homogeneous coordinates}. Let $k$ be a field. Consider $k^{n+1}\setminus{(0,0,\ldots,0)}$. We define $\P^n$ to be:
\[\P^n:=\lbrace (x_0,x_1,\ldots,x_n)\; |\; (x_i)\simeq (y_i)\; \text{if there is a $\lambda\in k^{\times}$ such that for all $i$,}\; x_i=\lambda y_i\rbrace\]

We denote the equivalence class of the tuple $(x_i)$ by $[x_0:x_1:\ldots:x_n]$. These are called homogeneous coordinates. If we assume one of the coordinates to be non-zero, say $x_i$, then we can divide the entire tuple by it. This gives us a set, $D(x_i):=\lbrace [x_0/x_i:x_1/x_i:\ldots:1:\ldots:x_n/x_i]\rbrace$. It is easy to see that this set in bijection with $k^n$. Set $x_k/x_i:=x_{k/i}$\footnote{This notation is meant to be suggestive.}, then tuples in $D(x_i)$ look like $[x_{0/i}:x_{1/i}:\ldots:1:\ldots:x_{n/i}]$. This $D(x_i)$ should be thought of as the complement of the hyperplane defined by $x_i$ (which is actually a projective space of one dimension less). 

If an $x_j$ is non-zero, for a $j$ distinct from $i$, then we can divide by it. This gives us the relation, $x_{k/i}/x_{j/i}=x_{k/j}$. This is the origin of the morphisms $\phi_{ij}$ above\footnote{If you have seen the construction of Grassmannians as smooth manifolds, the same construction also goes through in algebraic geometry.}. Homogenisation and de-homogenisation(?).


\subsection{Proj of a graded ring.}\label{subsection-proj-construction}\marginnote{000C}
Now that we have defined $\P^n$, I want to motivate the proj construction for graded rings using the example of $\P^n$. In a sense, this construction is not very different from the gluing construction above. However, it gives us more control ove the algebra and sheaf theory of $\P^n$ and its subschemes. For example, every closed subscheme of $\P^n$ comes from a graded ideal (this is a neat analogue of the affine case). Another advantage is that it lets us talk about affine open covers given by the complements of non-linear hypersurfaces. This can be useful when dealing with closed subschemes of $\P^n$, but then we won't need to make any choices about waht affine covers should be. 

Consider the ring $S_{\bullet}:=k[x_0,x_1,\ldots,x_n]$, now thought of as a graded ring with the grading given by degrees of monomials. The degree of a monomial $x^{r_1}_{i_1}\ldots x^{r_m}_{i_m}$ is the integer $r_1+\ldots +r_m$. The constants have degree zero. We can write our ring as $S_{\bullet}=\oplus_{i\geq 0}S_i$, where each $S_i$ is the homogeneous component of degree $i$. Note that $S_{\bullet}$ is generated by the elements $x_i$'s as an $S_0$-algebra (here, $S_0$ is $k$). The ideal generated by the $x_i$'s is just $S_{+}=\oplus_{i>0}S_i$. This is just the ideal $(x_0,\ldots,x_n)$ written by keeping track of the grading. We will call this the irrelevant ideal. Then, proj of the graded ring $S_{\bullet}$, $\Proj(S_{\bullet})$ is the set of those \text{homogeneous} prime ideals which do not contain $S_+$. This inherits a Zariski topology from $\Spec S_{\bullet}$. We can then to check that this is a scheme by producing affine open covers using the homogeneous elements. The resulting scheme is $\P^n$.

This can be a bit tricky to write down when the homogeneous elements have large degrees. But to give you a flavour of what is going on, let's examine what this is in for $\P^1$. We have already seen a description of $\P^1$ above, by gluing $\A^1\setminus 0$ in an ``inverse fashion".  By the above discussion, $\P^1:=\Proj k[x,y]$. Here's a slightly different description of $\P^1$ using degree $2$ hypersurfaces. Consider the homogeneous ideal $(x^2,xy,y^2)$. Localise $k[x,y]$ with respect to $x^2$. This gives us a graded ring $(S_{\bullet})_{x^2}=k[x,y]_{x^2}$, where $1/x^2$ has degree $-2$. Thus, elements here are of the form $f(x,y)/(x^{2})^N$ and can have negative degrees. Look at the zero graded piece of this ring which we will denote by the horrible notation, $((S_{\bullet})_{x^2})_0$. This ring can be described as,
\[((S_{\bullet})_{x^2})_0=k[xy/x^2,y^2/x^2].\]
This can be identified with $k[y/x]$. So, $\Spec ((S_{\bullet})_{x^2})_0=\A^1$. At this point, we have to check that this does give an affine open in $\Proj k[x,y]$. This is true because there is a bijection between prime ideal of $((S_{\bullet})_{x^2})_0$ and the homogeneous prime ideals of $(S_{\bullet})_{x^2}$ (One way is easy. For the other direction, take a prime $\mathfrak{p}$ in $((S_{\bullet})_{x^2})_0$ and show that the \textit{radical} of the homogeneous ideal generated by $\mathfrak{p}$ in $(S_{\bullet})_{x^2}$ in prime\footnote{There is nothing particularly enlightening in doing this exercise for $x^2$, the exact same proof works for any element of positive degree.}). Similarly, inverting the elements $xy$ and $y^2$ in $S_{\bullet}$ and looking at the zeroth graded pieces gives us the polynomial rings,
\begin{align*}
((S_{\bullet})_{y^2})_0 &=k[x^2/y^2,xy/y^2]\longleftrightarrow \A^1\\
((S_{\bullet})_{xy})_0 &=k[x^2/xy,y^2/xy]\longleftrightarrow \A^1\setminus 0.
\end{align*}
The radical of the ideal $(x^2,xy,y^2)$ contains the irrelevant ideal (why?). This implies that every homogeneous prime ideal is contained in one of the above three affine pieces. Thus, this gives us a covering of $\P^1$.

If instead we invert degree one elements $x$ and $y$, the zeroth graded pieces of these localisations look like,
\begin{align*}
((S_{\bullet})_{x})_0 &=k[x/y]\longleftrightarrow\A^1\\
((S_{\bullet})_{y})_0 &=k[y/x]\longleftrightarrow\A^1.
\end{align*}
This will, then, recover our original construction of $\P^1$.

Note that if you just invert $x^2$ and $xy$, then this does not give a cover $\P^1$, since the the radical of $(x^2,xy)$ does not contain the irrelevant ideal. Geometrically speaking, this is because inverting $xy$ corresponds to the affine open of $\P^1$ obtained by removing $0$ and $\infty$. However, the radical of the ideal $(x^2,y^2)$ does, indeed, contain the irrelevant ideal\footnote{This was pointed out to me by Kartik Roy.}. This makes geometric sense because the elements $x$ and $x^2$ have the same vanishing locus.

\subsection{Closed subschemes of \texorpdfstring{$\P^n$}{Pn}.}
\label{subsection-closed-in-proj}\marginnote{000D}
Just as in closed subschemes of an affine scheme $\Spec R$, are given by ideals $I\subset R$, closed subschemes of $\P^n$ correspond to homogeneous ideals of $k[x_0,\ldots,x_n]$.

Let $Y\overset{i}{\hookrightarrow} \P^n$ be a closed subscheme. This is given by a sheaf of ideals $\sI$ such that,

\[0\rightarrow \sI\rightarrow \sO_{\P^n}\rightarrow i_*\sO_Y\rightarrow 0.\]

On $D(x_i)$, this gives us an injection,
\[0\rightarrow \sI_{x_i}\rightarrow k[x_{0/i},x_{1/i},\ldots,\ldots,x_{n/i}]/(x_{i/i}-1). \]

Let $\sI_{x_i}$ be generated by a collection of polynomials $(f_1,\ldots,f_r)$ on $D(x_i)$. If the degree of highest degree term of $f_j$ is $r$, then $x_i^rf_j$ is a homogeneous polynomial in $\lbrace x_0,\ldots,x_n\rbrace$ which we will also call $f_j$, by abuse of notation. Doing this for every $D(x_j)$, gives us a collection of homogeneous elements of $k[x_0,\ldots,x_n]$. Let $I$ be the homogeneous ideal generated by these elements. More precisely,
\[I:=\lbrace (f_{kl})\;|\; \text{the elements}\; \lbrace f_{ki}\rbrace_k\; \text{generate}\; \sI_{x_i}\rbrace\]
We claim that $\tilde{I}=\sI$. To do this, it is sufficient to show that if $f_1,\ldots f_r$ are homogeneous elements of $k[x_0.\ldots,x_n]$ which generate $\sI_{x_i}$, and $g_1,\ldots,g_s$ are homogeneous elements of $k[x_0.\ldots,x_n]$ which generate $\sI_{x_j}$, then $f_l|_{D(x_j)}\in \sI_{x_j}$.

Note that on $D(x_i x_j)$ we have isomorphisms,
\begin{align*}
k[x_{0/i},\ldots,\widehat{x_{i/i}},\ldots,x_{n/i}]_{x_{j/i}} &\rightarrow k[x_{0/j},\ldots,\widehat{x_{j/j}},\ldots,x_{n/j}]_{x_{i/j}}\\
x_{k/i} &\overset{\phi_{ij}}{\longrightarrow} \frac{x_{k/j}}{x_{i/j}}\\
\frac{x_{k/i}}{x_{j/i}} &\overset{\phi_{ji}}{\longleftarrow} x_{k/j}.
\end{align*}
Now by the sheaf property, $\sI_{x_i}|_{D(x_i x_j)}=\sI_{x_j}|_{D(x_i x_j)}$. Thus, any generator $f_l$ of $\sI_{x_i}$ can be expressed in terms of the generators $g_k$'s of $\sI_{x_j}$ on $D(x_i x_j)$, and vice verse.

Write $f_l=f_l(x_{0/i},\ldots,x_{n/i})$, and $g_k=g_k(x_{0/j},\ldots,x_{n/j})$. Then, on $D(x_i x_j)$, we have,
\[ f_l(x_{0/i},\ldots,x_{n/i})= f_l(\frac{x_{0/j}}{x_{i/j}}, \ldots,\frac{x_{n/j}}{x_{i/j}})=\sum_k \frac{\alpha_k g_k}{x_{i/j}^{r_k}}, \]
where $\alpha_k\in k[x_{0/j},\ldots,\widehat{x_{j/j}},\ldots,x_{n/j}]_{x_{i/j}}$. Let degree of the highest degree term of $f_l(x_{0/i},\ldots,x_{n/i})$ be $N$. Then, multiplying throughout by $x_{i/j}^N$, gives us
\[x_{i/j}^N f_l(\frac{x_{0/j}}{x_{i/j}},\ldots,\frac{x_{n/j}}{x_{i/j}})= f_l(x_{0/j},\ldots,x_{n/j})=\sum_k  x_{i/j}^{N-r_k} \alpha_k g_k.\]
Thus, $f_l|_{D(x_j)}\in \sI_{x_j}$. A similar argument shows that $g_k\in \sI_{x_i}$.

\noindent\textbf{Possible alternative approach.} Just as in the case of $\P^1$, we can define the line bundles $\sO(n)$'s whose global sections are degree $n$ polynomials. Therefore, we can write that $k[x_0,\ldots,x_n]=\oplus_m\Gamma (\sO(m),\P^n)$. For the exact sequence
\[0\rightarrow \sI\rightarrow \sO_{\P^n}\rightarrow i_*\sO_Y\rightarrow 0,\]
tensoring by $\sO(m)$ gives,
\[0\rightarrow \sI(m)\rightarrow \sO_{\P^n}(m)\rightarrow i_*\sO_Y(m)\rightarrow 0.\]

Since taking global section is a left exact functor, we have an injection for each $m$,
\[\Gamma (\sI(m),\P^n)\rightarrow \Gamma (\sO_{\P^n}(m)).\]

Let $I=\oplus_m \Gamma (\sI(m),\P^n)\subset \oplus_m\Gamma (\sO(m),\P^n) = k[x_0,\ldots,x_n]$. Is $\tilde{I}=\sI$?\footnote{I suspect that this $I$ is the same as the one constructed earlier by homogenising the generators of the affine opens, since the gluing maps on $\sO(m)$ are just mulplication by the $m$-th power of some $x_i$.}. [Discussed till here as of Spetember 4, 2020]

\subsection{Some more examples.}

\begin{example}
An example of a non-Noetherian scheme is $\Spec R[x_1,x_2,\ldots]$. 
\end{example}


\begin{example}\label{example-forms}\marginnote{000E}
$V_{+}(x^2+y^2+z^2)$ over $\R$ and $\C$. $V_{+}(x^2+y^2+z^2)$ denotes the homogeneous prime ideals which contain the ideal $(x^2+y^2+z^2)$. Let $k=\R$ or $\C$. Consider, $\P_k^2=\Proj k[x,y,z]$. By the above discuss on closed subschemes of $\P^n$, $V_{+}(x^2+y^2+z^2)$ can be thought of as the closed subscheme $X=\Proj k[x,y,z]/(x^2+y^2+z^2)\subset \P_k^2$. This gives a curve in $\P_k^2$.\\
Over $\C$, one have the following linear change of coordinates, 
\[(x,y,z)\mapsto (x+iy,x-iy,iz).\] 
Denote $u:=x+iy$ and $v:=x-iy$. Then, $(x+iy) (x-iy) -(iz)^2= x^2+y^2+(iz)^2$. So, $V_{+}(x^2+y^2+z^2)$ is the same as subscheme defined by $V_+(uv-z^2)$. The latter is the (2-fold-)Veronese embedding of $\P^1$ in $\P^2$ given by $[x:y]\mapsto [x^2:xy:y^2]$\footnote{Similarly, the $d$-fold Veronese embedding is given by $[x:y]\mapsto [x^d:x^{d-1}y:\ldots:xy^{d-1}:y^d]$.}. In terms of rings,
\begin{align*}
k[x,y,z]&\rightarrow k[x,y]\\
(x,y,z)&\mapsto (x^2,y^2,xy)
\end{align*}
The image of this map is the subring $k[x^2,y^2,xy]\subset k[x,y]$ generated by degree $2$ elements. Thus, $X\simeq \P_{k}^1$ over $\C$.

On the other hand, over $\R$ the equation $x^2+y^2+z^2$ has no real solutions. Since, $\P_{\R}^1$ clearly has lots of real solutions, $X$ is not isomorphic to $\P^1$ over $\R$.
\end{example}


\begin{remark}[Forms]\label{remark-forms}\marginnote{000F}
	Note that $V_+(x^2+y^2+z^2)\subset \P_{\R}^2$ has the following interesting property: $V_+(x^2+y^2+z^2)\times_{\R}\Spec \C\simeq \P_{\C}^1$, but $V_+(x^2+y^2+z^2)$ itself not isomorphic to $\P_{\R}^1$. In algebra, this is the notion of a ``form": these are objects that become the given object \textit{after a field extension}. For example, algebraic tori become isomorphic to $\G_m^n$ after field extension. In geometry (especially differential geometry), this notion is called local triviality\footnote{The word ``local" needs to be interpreted correctly. We will do this in section \ref{section-sites}.}.
	
	Things which become projective space after field extension - like $V_+(x^2+y^2+z^2)$ - are called  \textit{Brauer-Severi varieties}.
\end{remark}

\begin{example}\label{example-blow-up}\marginnote{000G}
	Blow-up of $\A^2$ at the origin. This is described as 
	\[Y:=\lbrace ((x,y),[X:Y])\subset \A^2\times\P^1\; |\; xY=yX\rbrace\]
	This comes with a projection map $p: Y\rightarrow \A^2$. Observe that outside the origin this is an isomorphism, i.e, $p^{-1}(\A^1\setminus 0)=\A^1\setminus 0$, and $p^{-1}(0)=\P^1$. Blow-up can be defined canonically using the Proj construction. If $I$ is an ideal of $\Spec A$, then Blow-up along $V(I)$ is $\Proj(\oplus_{n\geq 0}I^n)$. Observe that $\oplus_{n\geq 0}I^n$ can be thought of as a graded ring over $I^0:= A$. One can sheafify this construction to define blow-ups in arbitrary schemes\footnote{You will have to make sense of the Proj of a sheaf of graded algebras first! Do this by gluing the affine local patches.}.%(because everyone should know about blow-ups!)
	
	%One way to interpret this example is that it is moduli space of all lines in the origin.
\end{example}


\begin{example}
	An example of a scheme without a closed point. This one is a bit involved but idea is as follows. There is a valuation on the fraction field of the polynomial ring in infinitely many variable, such that every non-maximal prime ideal is contained in a non-maximal prime ideal\footnote{This example is due to Florian Pop. See Liu's book \cite[\S 3.3, Exercise 3.27]{Liu}.}. Then, knocking off the maximal ideal gives a scheme without any closed point. This scheme is \textit{not} quasi-compact. The construction is as follows:
\begin{enumerate}
	\item Let $I$ be a totally ordered set, and $k$ a field. Let $K=k(T_i)_{i\in I}$ be the fraction field with variables indexed over $I$. Let $\Gamma = \Z^{(I)}$ be the direct sum of copies $\Z$ indexed over $I$. This is an abelian group which is totally ordered (the order is given by the lexicographic order). Denote by $\lbrace e_i \rbrace_{i\in I}$ the canonical basis of $\Gamma$. Then there exists a unique valuation (upto isomorphism) $\nu : K^*\rightarrow \Gamma$ such that $\nu(T_i)=e_i$ and $\nu(k^*)=0$. Denote by $\sO_{\nu}$, the associated valuation ring.
	\item Let $\mathfrak{p}(i):=\lbrace a\in K \,|\, \nu (a)\geq e_i \rbrace$, for $i\in I$. Then the radical of $\mathfrak{p}(i)$ is a prime ideal of the valuation ring $\sO_{\nu}$.
	\item This gives a set map $I \rightarrow \Spec\sO_{\nu}$, which is injective and increasing. The order on $\Spec\sO_{\nu}$ is determined by inclusion of prime ideals.
	\item Let $\theta:\Z^{(I)}\setminus 0\rightarrow I$ be the map defined by  $\theta(\lbrace n_i\rbrace_i)=$ the smallest $i$ such that $n_i\neq 0$.
	\item If $\mathfrak{p}\in \Spec\sO_{\nu}$, and $\theta(\nu(\mathfrak{p}))$ is bounded from above by an index $i$, then for every $j\geq i$, we have $\mathfrak{p}\subset \mathfrak{p}(j)$. Moreover, if $\theta(\nu(\mathfrak{p}))$ is unbounded then $\mathfrak{p}=\mathfrak{m}_{\nu}$ is the maximal ideal.
	\item Then $\Spec\sO_{\nu}\setminus \mathfrak{m}_{\nu}$ is the required example.
\end{enumerate}
	
\end{example}

\underline{Note:} Looking at the above example, it may seem like this argument should work for the spectrum of any local ring $\sO$. However, any quasi-compact scheme has a closed point. This already rules any Notherian examples.


\section{Morphisms}
As mentioned before, many of the properties of morphisms that we are interested in are ``globalised" versions of properties of ring maps. However, we have to first say what it means for morphism of schemes to be a local property. There are three kinds of local properties: local on the source, local on the target, local on the source and target. We will say what this means now:

\begin{definition}\label{definition-locally-P-morphisms}\marginnote{000H}
	Let $\mathcal{P}$ be a property of morphisms of schemes. Let $f:X\rightarrow Y$ be a morphism which satisfies $\mathcal{P}$. Then,
	\begin{enumerate}
		\item We say that $\mathcal{P}$ is \textit{affine-local on the target} if given any affine open cover $\lbrace V_i\rbrace$ of $Y$, $f:X\rightarrow Y$ has $\mathcal{P}$ if and only if the restriction $f: f^{-1}(V_i)\rightarrow V_i$ has $\mathcal{P}$ for each $i$.
		\item We say that $\mathcal{P}$ is \textit{affine-local on the source} if given any affine open cover $\lbrace U_i\rbrace$ of $X$, $X\rightarrow Y$ has $\mathcal{P}$ if and only if the composite $U_i\rightarrow Y$ has $\mathcal{P}$ for each $i$.
		\item We say that $\mathcal{P}$ is \textit{stable under base-change} if given any other morphism $Z\rightarrow Y$, the projection to $Z$ from the fibre product, $f_Z: X\times_Y Z\rightarrow Z$ also has $\mathcal{P}$.
	\end{enumerate}
\end{definition}

Using \textit{affine communication lemma} one can then show that it suffices to check statements (1) and (2) on single affine open cover.


An important maxim of Grothendieck is that instead of considering schemes in isolation, we should look at things relative to each other, i.e, everything should be seen as a propery of morphisms. Then properties of schemes should really be thought of as properties of morphisms $X\rightarrow\Spec \Z$ (or whatever base you are working over. For a lot of people it is the spectrum of a field). This is mostly true: many property of schemes can be turned into properties of morphisms of schemes\footnote{For example, affine opens form a basis for the topology on a scheme. Can this statment be ``relativised" to affine morphisms $X\rightarrow Y$? I don't know the answer.}.

\subsection{To be (or not to be) Noetherian.} The discussion in \ref{subsection-P-versus-locallyP} also applies to properties of morphisms, i.e., a morphism is said to be $P$ if it is locally $P$ and quasi-compact: a morphism is finite-type if it is locally finite type and quasi-compact; quasi-finite if it is locally quasi-finite and quasi-compact.

However, this is not true of finite presentation. A morphism is of finite presentation if it is locally of finite presentation, quasi-compact \textit{and quasi-separarted}. This is because. really, finite presentation is a condition to correct for non-Noetherian-ness over arbitrary bases. Note that for Noetherian schemes, a morphism (locally) of finite type is automatically (locally) of finite presentation. Furthermore, quasi-separatedness is automatic for Noetherian scheme. There is a very nice discussion on mathoverflow on this that I encourage you to look up\footnote{\href{https://mathoverflow.net/questions/36737/why-does-finitely-presented-imply-quasi-separated}{https://mathoverflow.net/questions/36737/why-does-finitely-presented-imply-quasi-separated}}. 


\begin{example}
	Consider the map $f:k[x]\rightarrow k[x]$ given by $x\mapsto x^2$. Note that $x$ satisfies the polynomial $t^2 - x^2$ in $k[x^2][t]$, thought of as a polynomial ring in the variable $t$. Thus, this map is an integral extension of ring. Furthermore, we have a morphism of $k[x]$-algebras, $k[x,y]\rightarrow k[x]$ given by $(x,y)\mapsto (x^2,x)$, whose kernel is generated by the ideal $(x-y^2)$. This shows that it is a morphism of finite presentation, and hence is finite.
\end{example}

\begin{example}
	Continuing with the above morphism $x\mapsto x^2$. We will show that for $k=\C$  it is unramified everywhere except at the origin.\\
	\underline{At origin:} Localising at the ideal $(x)$, we get,
	\begin{align*}
	f: \C[x]_{(x)}&\rightarrow \C[x]_{(x)}\\
	x &\mapsto x^2.
	\end{align*}
	As $x$ generates the maximal ideal in $\C[x]_{(x)}$. On the other hand, the image $x^2$ generate the square of the maximal ideal, since $(x)^2=(x^2)$\footnote{This is true, more generally, in any discrete valuation ring.}. This implies that $f$ is ramified at the origin.
	\underline{At other points:} Let $(x-p)$ be a point. Localising at $x-p$ and its inverse image, we get,
	\begin{align*}
	f: \C[x]_{(x-p^2)}&\rightarrow \C[x]_{(x-p)}\\
	x-p^2 &\mapsto x^2-p^2.
	\end{align*}
	Since $x+p$ is invertible in $\C[x]_{(x-p)}$, we see that $f(x-p^2)$ generates the maximal ideal.
\end{example}
	
The above is a prototypical example of many kinds of morphisms.

\begin{example}
	Consider the inclusion $U:=\Spec k[x_1 ,x_2 ,\ldots] \setminus\lbrace (x_1 ,x_2 ,\ldots)\rbrace\hookrightarrow \Spec k[x_1 ,x_2 ,\ldots]$. This map is an open immersion which is not quasi-compact.% Take any finite covering of $\Spec k[x_1,x_2,\ldots]$, then the inverse image is not cover of $U$: we can reduce to distinguished affines to show this. If $\Spec k[x_1,x_2,\ldots]$ is covered by finitely many distinguished affines, then we have finitely many polynomials $f_i$'s corresponding to these open set. Let $x_N$ be that largest variable appearing in any of the $f_i$. Then, the $(x_{N+1},x_{N+2},\ldots)$
\end{example}
	
	
\begin{example}\label{example-family-nodal}\marginnote{0017}
	Consider the nodal curve over $\A^1$ given by $\Proj k[t][X,Y,Z]/(XY-tZ^2)\rightarrow \Spec k[t]$. Affine locally, this has the form,
	\[k[t]\rightarrow k[t][X,Y]/(XY-t).\]
	Differentiating with respect to $X$ and $Y$, we get the Jacobian $[Y\;\; X]$. This can be zero only when $t=0$. Geometrically, this is a family of hyperbolas which degenerate to a pair of lines when $t=0$. Note that the restriction of this curve to $D(Y)$ and $D(X)$, are smooth (it given by the equations $X-tZ^2$ and $Y-tZ^2$ which are families of parabolas degenerating to the axes). Seen from the opposite view-point, this tells us that homogenisation of smooth curves is not necessarily smooth!
\end{example}

\begin{remark}[Le sorite for open immersions]
Open embeddings are locally of finite presentation\footnote{This is not true in perfectoid geometry, which is quite sad.}. Moreover we have the following implications:

Open embedding $\Rightarrow$ \'{e}tale $\Rightarrow$ flat and locally of finite presentaion $\Rightarrow$ flat.
\end{remark}

\begin{comment}
\begin{enumerate}
	\item $x\mapsto x^2$ (more, generally $x^n$). This morphism is ramified at the origin (but unramified on $\A^1\setminus \lbrace 0\rbrace$), finitely presented, flat.
	\item A non-quasi-compact open immersion. $\Spec k[x_1,x_2,\ldots]\setminus\lbrace (x_1,x_2,\ldots)\rbrace\hookrightarrow \Spec k[x_1,x_2,\ldots]$ Polynomial ring in infinitely many variables and knock off the origin.
	\item A finite morphism. 
	\item A smooth morphism. A non-smooth morphism (nodal curve over $\A^1$).
	\item Open embeddings are locally of finite presentation\footnote{This is not true in perfectoid geometry, which is quite sad.}.
	\item Open embedding is \'{e}tale is fppf is fpqc.
\end{enumerate}
\end{comment}


\begin{example}[Separatedness is not a local property]
	 \label{example-not-local-property}
	 Not all properties can be described locally. For example, take the line with the double origin. Then on each of the two $\A^1$'s is separated, but the whole scheme is not. 
	
Note, however, that separatedness is stable under base-change. A similar statement is true about properness.
	
\end{example}


\subsection{Morphisms to \texorpdfstring{$\P^n$}{Pn}.}
\label{subsection-functor-of-Pn}\marginnote{000J} 

Let $X$ be a scheme. Then a morphism $X\rightarrow\P^n$ is the same as a line bundle $\sL$ on $X$ and $n+1$ sections $s_0,\ldots,s_n \in \Gamma (\sL,X)$ which globally generate $\sL$\footnote{This means that the global sections correspond to a surjection of sheaves $\sO_X^{\oplus n+1}\twoheadrightarrow \sL$}. Note that given a morphism $f: X\rightarrow \P^n$, the pullback $f^* \sO(1)$ and the global sections $f^*x_i$ is such a datum.

Given such line bundle $\sL$ with $n+1$ sections which globally generate it, we will construct a morphism to $\P^n$. Consider the open set $X_i$ (why is this open?) of $X$ given by,
\[X_i:=\lbrace p\in X \, |\, s_i\notin \mathfrak{m}_p\sL_p\rbrace.\]
This gives us $n$ sections $s_0/s_i,\ldots,s_n/s_i$ on $X_i$. Thus, we get a map $f_i:X_i\rightarrow \A^n$ corresponding to these sections. We can identify this $\A^n$ with $D(x_i)$. It is now suffices to check that $f_i$'s agree on the intersections. This follows because $s_j/s_i$ is invertible on $X_i\cap X_j$.


\section{Sites, Sheaves, and Representable functors}\label{section-sites}\marginnote{000K}

In this section, we will collect all the ``sheafy jargon"\footnote{This may or may not be used in the sequel.} As I have mentioned before, modern Moduli theory is set in this language. Hence, it is a good idea to review some key points. More details can be found in Vistoli's notes on Descent (Chapter 1 of FGA Explained, \cite{FGAExplained}) or the Stacks project \cite{stacks-project}.

\subsection{A Commutative Algebra Detour.}
We begin with the following lemma which we will use at the end of this section to prove Theorem \ref{theorem-fpqc-representable}.

\begin{lemma}[Amitsur's Lemma]\label{lemma-Amitsur}\marginnote{000L}
Let $f: A\rightarrow B$ be a faithfully flat ring map. Then the following sequence of $A$-modules is exact:
\begin{equation}\label{equation-fpqc-modules}\marginnote{0018}
0\rightarrow A\overset{f}{\rightarrow} B \overset{e_1-e_2}{\rightarrow} B\otimes_A B.
\end{equation}
Here, $e_1$and $e_2$ are the inclusions $b\otimes 1$ and $1\otimes b$, respectively.
\end{lemma}
\begin{proof}
Note that since $f$ is faithfully flat, it is injective (why?), and that $(e_1-e_2)\circ f=0$. So, we only need to check that $Ker(e_1-e_2)\subseteq Im(f)$.

Let us first consider the special case when $f:A\rightarrow B$ is a retract, i.e, there exists a $g:B\rightarrow A$ such that $g\circ f = id_A$. Now, take a $b\in Ker(e_1-e_2)$, so that  $b\otimes 1 = 1\otimes b \in B\otimes_A B$. The retraction $g$ gives us a map $B\otimes_A B\overset{g\otimes id}{\rightarrow} A\otimes_A B\simeq B$. Applying this to the previous equality gives, $g(b)\otimes 1=1\otimes b$, which is the same as $g(b)\cdot 1=b$. Now, note that $f(g(b)\cdot 1)=g(b)\cdot f(1)=b$, since $f$ is an also $A$-module homomorphism, showing exactness.

Now, observe that tensoring (\ref{equation-fpqc-modules}) with $\otimes_A B$ gives a sequence,
\[0\longrightarrow A\otimes_A B\overset{f\otimes id}{\longrightarrow} B\otimes_A B \overset{(e_1-e_2)\otimes id}{\longrightarrow} B\otimes_A B\otimes_A B.\]
The map $f\otimes id$ is also a faithfully flat ring map. Moreover, it has a retraction\footnote{All these statements about retractions are just a dual way for saying that the map $\Spec B\rightarrow \Spec A$ has a section.} $g: B\otimes_A B\rightarrow A\otimes_A B$ given by $b\otimes b'\mapsto 1\otimes bb'$. Thus, this sequence is exact. Now, faithful flatness implies the exactness of (\ref{equation-fpqc-modules}).
\end{proof}


\begin{remark}
Observe that the above lemma holds for any faithfully flat $A$-module $M$, i.e, the sequence of $A$-modules,
\[0\longrightarrow M\overset{id\otimes f}{\longrightarrow} M\otimes_A B \overset{id\otimes (e_1-e_2)}{\longrightarrow} M\otimes_A B\otimes_A B,\]
is exact. You may ask what is happening at the map $id\otimes (e_1-e_2)$. To answer this, note that we can extend this above sequence to higher tensor powers,
\[0\longrightarrow M\overset{id\otimes f}{\longrightarrow} M\otimes_A B \overset{id\otimes (e_1-e_2)}{\longrightarrow} M\otimes_A B\otimes_A B\rightarrow M\otimes_A B\otimes_A B\otimes B\rightarrow\ldots.\]
The map 
\[M\otimes_A B\otimes_A B\rightarrow M\otimes_A B\otimes_A B\otimes B\]
can be described on pure tensors as the alternating sum,
\[m\otimes b\otimes b'\mapsto m\otimes b\otimes b'\otimes 1- m\otimes b\otimes 1\otimes b + m\otimes 1\otimes b\otimes b'.\]
The higher tensor powers are described similarly as alternating sums\footnote{This is can be stated more cleanly in terms of (co)simplicial objects. All we doing is taking the chain complex associated to the cosimplicial diagram of $M$.}. Then, this extended chain complex is exact. Essentially, this characterises effective descent for fpqc morphisms (see \cite[Tag 023F]{stacks-project} for more on this).
\end{remark}

We will now discuss some ``sheafy jargon".

\begin{definition}
	\label{definition-family-morphisms-fixed-target}\marginnote{000M}
	Let $\mathcal{C}$ be a category. A {\it family of morphisms with fixed target} in $\mathcal{C}$ is	given by an object $U \in \Ob(\mathcal{C})$, a set $I$ and
	for each $i\in I$ a morphism $U_i \to U$ of $\mathcal{C}$ with target $U$.
	We use the notation $\{U_i \to U\}_{i\in I}$ to indicate this.
\end{definition}

Our categories will almost always admit fiber products.

\begin{definition}
	\label{definition-site}\marginnote{000N}
	A {\it site}\footnote{This notation differs from that of SGA4. This is what they call a category with a pretopology.} is given by a category $\mathcal{C}$ and a set
	$\text{Cov}(\mathcal{C})$ of families of morphisms with fixed target
	$\{U_i \to U\}_{i \in I}$, called {\it coverings of $\mathcal{C}$},
	satisfying the following axioms
	\begin{enumerate}
		\item If $V \to U$ is an isomorphism then $\{V \to U\} \in
		\text{Cov}(\mathcal{C})$.
		\item If $\{U_i \to U\}_{i\in I} \in \text{Cov}(\mathcal{C})$ and for each
		$i$ we have $\{V_{ij} \to U_i\}_{j\in J_i} \in \text{Cov}(\mathcal{C})$, then
		$\{V_{ij} \to U\}_{i \in I, j\in J_i} \in \text{Cov}(\mathcal{C})$.
		\item If $\{U_i \to U\}_{i\in I}\in \text{Cov}(\mathcal{C})$
		and $V \to U$ is a morphism of $\mathcal{C}$ then $U_i \times_U V$
		exists for all $i$ and
		$\{U_i \times_U V \to V \}_{i\in I} \in \text{Cov}(\mathcal{C})$.
	\end{enumerate}
\end{definition}

A category  satisfying the above definition is said to be equipped with a \textit{Grothendieck topology}. Thus, a site is a category with a Grothendieck topology.

\subsection{Various Topologies on Affine Schemes.} Let $\mathit{Ring}^{op}$ or $\mathit{Aff}$ denote the category of affine schemes. Let $I$ be a finite set. We can define the following Grothendieck topologies\footnote{This list is by no means exhaustive. Some notable exculsions are the \textit{Nisnevich} and \textit{smooth} topologies.} on it:

\begin{enumerate}
	\item[\textit{Zariski:}]  Coverings are families of ring maps $\{ R \overset{f_i}{\to} R_{r_i}\}_{i \in I}$, where $R_{r_i}$ is the localisation with respect to $r_i\in R$ such that $(\{r_i\}_{i\in I})= R$.
	\item[\textit{\'{E}tale}:] Covering are families of \'{e}tale ring maps $\{ R \overset{f_i}{\to} R_i\}_{i \in I}$ such that the product $\prod_i f_i$ is faithfully flat.
	\item[\textit{fppf}:] Coverings are families of ring maps $\{ R \overset{f_i}{\to} R_i\}_{i \in I}$ which are flat, finite presentation and such that the product $\prod_i f_i$ is faithfully flat. (fppf: fid\`{e}lement plat et de pr\'{e}sentation fini)
	\item[\textit{fpqc}:] Coverings are families of morphisms $\{ R \overset{f_i}{\to} R_i\}_{i \in I}$ such that each $f_i$ is faithfully flat. (fpqc: fid\`{e}lement plat et quasi-compacte)
\end{enumerate}
\text

%Note that if $I$ is not finite, then the above definitions do not give a meaningful notions of topology. This is because $\amalg_{i\in I}\Spec A_i$ is not isomorphic to $\Spec \prod_{i\in I} A_i$, but we want the faithful flatness to the product map $\prod_i f_i$ to represent surjectivity of the map $\amalg_{i\in I}\Spec A_i $\rightarrow$ \Spec A$. This makes sense only when $I$ is finite. This is a reasonable assumption to make because all objects are quasi-compact.

Note that all the rings maps in the topologies above are used to define local properties of morphisms of schemes which are also stable under base change. Hence, we can extend these toplogies to schemes.

\subsection{Various Topologies on Schemes.}
Let $(\mathit{Sch})$ be the category of schemes. We will now ``globalise" the topologies defined for affine schemes to schemes. Note, however, the important change that needs to be made to get the correct notion of \textit{fpqc} coverings:


\begin{enumerate}
	\item[\textit{Zariski:}]  Coverings are families of open immersions $\{ U_i \overset{f_i}{\to} U\}_{i \in I}$ such that $U= \bigcup_i f(U_i)$.
	\item[\textit{\'{E}tale:}] Covering are families of \'{e}tale morphisms $\{ U_i \overset{f_i}{\to} U\}_{i \in I}$ such that $U= \bigcup_i f(U_i)$.
	\item[\textit{fppf:}] Coverings are families of morphisms $\{ U_i \overset{f_i}{\to} U\}_{i \in I}$ such that each $f_i$ is flat, locally of finite presentation and $U= \bigcup_i f(U_i)$.
	\item[\textit{fpqc:}] Coverings are families of morphisms $\{ U_i \overset{f_i}{\to} U\}_{i \in I}$ such that each $f_i$ is flat and for every affine open $V \subset U$ there exist quasi-compact opens $V_i \subset U_i$ which are almost all empty, such that $V = \bigcup f_i(V_i)$.
\end{enumerate}


\begin{remark}
	We have the follow inclusion of topologies:
	\[\textit{Zariski}\;\subset\; \textit{\'{E}tale}\;\subset\; \textit{fppf}\;\subset\; \textit{fpqc}.\]
	The first three inclusions are direct implications of the definitions. For the last one, take an fppf covering $\{ U_i \overset{f_i}{\to} U\}_{i \in I}$. Then by definition, since each $f_i$ is locally of finite presentation, for any affine open $V\subset U$, the inverse image in each $U_i$ can be written as $f_i^{-1}(V)=\cup_a U_{ia}$ where each $U_{ia}$ is affine and $f_i: U_{ia}\rightarrow V$ is flat and of finite presentation. Since, the $f_i$'s are jointly surjective, the union $\bigcup_{i,a}f_i(U_{ia})=V$. Note that this is a covering of $V$ by open sets since each $f_i$ is an open map. As $V$ is quasi-compact, this admits a finite refinement. This shows that $\{ U_i \overset{f_i}{\to} U\}_{i \in I}$ is an fpqc covering.
\end{remark}

In light of the above remark, note that if we simply define fpqc coverings to be morphisms of schemes which are faithfully flat and quasi-compact, then Zariski covers would no longer be fpqc coverings.


Let $S$ be a scheme. Let $(\mathit{Sch}/S)$ be the category of schemes over $S$. $\Ob(\mathit{Sch}/S)$ are given by morphisms $X\rightarrow S$ and morphisms are $S$-morphisms, i.e, commuting diagrams,
\begin{center}
	\begin{tikzcd}
	X\arrow[rd]\arrow[rr]& & Y\arrow[ld]\\
	&S&
	\end{tikzcd}
\end{center}
Similarly, we will denote by $(\mathit{Aff}/S)$, the category of affine morphisms to $S$.\\

The next two definitions capture some general notions about sites that good to know but not really essential.

\noindent\textbf{Notation:} For the next definition we will adopt the following terminology: Let $\mathcal{P}$ be a property of morphisms of schemes which is stable under composition and base change, and includes isomorphisms. A \textit{family of $\mathcal{P}$-morphisms} is collection of morphisms $\{U_i \overset{f_i}{\to} U\}_{i\in I}$ such that each $f_i\in \mathcal{P}$ and is jointly surjective, i.e, $U = \bigcup f_i(U_i)$. Since $\mathcal{P}$ is stable under composition and base change and includes isomorphisms, it is easy to see that these famililes will define a topology on $\mathit{Sch}$, which we will denote by $\tau$.


\begin{definition}[Big site, Small site]\label{definition-big-small-site}\marginnote{000P}
	Let $(\mathit{Sch}/S)$ be the category of schemes over $S$ and let $\tau$ be a topology on schemes which comes from families of $\mathcal{P}$-morphisms. We have the following conventions for topologies on $(\mathit{Sch}/S)$:
	\begin{enumerate}
		\item[\textsc{Big site:}] For the topology $\tau$, we denote the site by $(\mathit{Sch}/S)_{\tau}$ and call it the \textit{Big $\tau$ site}.
		\item[\textsc{Small site:}] Consider the full subcategory of $(\mathit{Sch}/S)$ whose objects are $f: X\rightarrow S$ such that $f\in\mathcal{P}$. We define coverings for this subcategory as families of $\mathcal{P}$-morphisms which are jointly surjective. We denote this site by $S_{\tau}$ and call it the \textit{Small $\tau$ site}.
	\end{enumerate}
\end{definition}
For example, we have the big and small Zariski sites, the big and small \'{e}tale sites etc.\footnote{People generally talk about small sites only in the Zariski and \'{e}tale topologies (and the Nisnevich topology if you are doing $\A^1$-homotopy theory)} The following is another notion which we will probably never use in this seminar\footnote{Unless we start discussing algebraic stacks at some point!}.


\begin{definition}[$\mathcal{P}$-$\mathcal{Q}$ site]
	Let $\mathcal{P}$ and $\mathcal{Q}$ be classes of morphisms that are stable under base change and composition, and contain isomorphisms. Then, the $\mathcal{P}$-$\mathcal{Q}$ site of $S$ is defined as follows: the objects are $S$-schemes, $f:X\rightarrow S$ such that $f\in \mathcal{P}$ and coverings are families of $\mathcal{Q}$-morphisms $\{U_i \overset{f_i}{\to} U\}_{i\in I}$ over $S$ which are jointly surjective.
\end{definition}

Notable examples are the smooth-\'{e}tale\footnote{Also called the lisse-\'{e}tale site. Lisse is french for smooth.} and the flat-fppf sites.

\subsection{Presheaves and the Yoneda Embedding.}

\begin{definition}
	Let $\mathcal{C}$ be a category. A \textit{presheaf of sets} or simply a \textit{presheaf} is a functor
	\[F:\mathcal{C}^{opp}\rightarrow \mathit{Sets}.\]
	We denote the cateogory of all presheaves by $\mathit{Psh}(\mathcal{C})$.
\end{definition}

\begin{example}[Functor of points]
	\label{example-hom-functor}\marginnote{000Q}

	For any $U\in \Ob(\mathcal{C})$ there is a
	functor
	$$
	\begin{matrix}
	h_U & : & \mathcal{C}^{opp}
	&
	\longrightarrow
	&
	\textit{Sets} \\
	& &
	X
	&
	\longmapsto
	&
	\textit{Mor}_\mathcal{C}(X, U)
	\end{matrix}
	$$
	which takes an object $X$ to the set
	$\textit{Mor}_\mathcal{C}(X, U)$. In other words $h_U$ is a presheaf.
	Given a morphism $f : X\to Y$ the corresponding map
	$h_U(f) :  \textit{Mor}_\mathcal{C}(Y, U)\to \textit{Mor}_\mathcal{C}(X, U)$
	takes $\phi$ to $\phi\circ f$. It is called the {\it representable presheaf} associated to $U$.
	If $\mathcal{C}$ is the category of schemes this functor is
	sometimes referred to as the
	\emph{functor of points} of $U$.
\end{example}

Note that given a morphism $\phi : U \to V$ in $\mathcal{C}$ we get a
corresponding natural transformation of functors $h(\phi) : h_U \to h_V$
defined by composing with the morphism $U \to V$. This turns
composition of morphisms in $\mathcal{C}$ into composition of
transformations of functors. In other words we get a functor
$$
h :
\mathcal{C}
\longrightarrow
\textit{PSh}(\mathcal{C}).
$$

The following lemma says that $h$ is a fully faithful embedding.

\begin{lemma}[Yoneda lemma]
	\label{lemma-yoneda}\marginnote{000R}
	Let $U, V \in \Ob(\mathcal{C})$.
	Given any morphism of functors $s : h_U \to h_V$
	there is a unique morphism $\phi : U \to V$
	such that $h(\phi) = s$. In other words the
	functor $h$ is fully faithful. More generally,
	given any contravariant functor $F$ and any object
	$U$ of $\mathcal{C}$ we have a natural bijection
	$$
	\mathit{Mor}_{\textit{PSh}(\mathcal{C})}(h_U, F) \longrightarrow F(U),
	\quad
	s \longmapsto s_U(\text{id}_U).
	$$
\end{lemma}

\begin{definition}
	\label{definition-representable-functor}\marginnote{000S}
	A presheaf $F : \mathcal{C}^{opp}\to \textit{Sets}$ is said
	to be {\it representable} if it is isomorphic to the functor of
	points $h_U$ for some object $U$ of $\mathcal{C}$.
\end{definition}

Seen one way, the basic objective in moduli theory is to show representability of various presheaves. We will often confuse a scheme $X$ with its associated functor $h_X$.

\begin{example}[Three representable functors]\label{example-three-representable}\marginnote{000T} 
	We will now describe three important functors which are representable\footnote{Convince yourself that all these assignments define presheaves of sets.}.
	\begin{enumerate}
		\item $X \mapsto \Gamma (X,\sO_X)^{\oplus n}$. This is same as giving a ring map $\Z[x_1,\ldots,x_n]\rightarrow \Gamma (X,\sO_X)^{\oplus n}$. But such a ring map corresponds a morphism to $\A_{\Z}^n$.
		\item $X \mapsto \Gamma (X,\sO_X)^{\times}$. A similar argument as above tells us that these are morphisms to $\A_{\Z}^1\setminus \{0\}:= \Spec \Z[t,t^{-1}]$.
		\item $X \mapsto \{ (\sL,s)\;|\; \text{$\sL$ is a line bundle on $X$ with a surjection}\; p:\sO_X^{n+1}\twoheadrightarrow \sL\}$. We have already seen in \ref{subsection-functor-of-Pn} that this is $\mathit{Hom}(-,\P^n)$.
	\end{enumerate}
\end{example}



\begin{example}[A non-representable functor]
	\label{example-functor-of-conics}\marginnote{000U} 
	I have taken this example from \cite{Bogges}. Let $k$ be an algebraically closed field. Consider the functor $F$ which assigns to any $k$-scheme $S$ a conic in $\P_S^2$ upto isomorphism. That is, 
	\begin{align*}
	F: (\mathit{Sch}/k)^{opp} & \rightarrow \mathit{Sets}\\
	S & \mapsto \left\{
	\begin{tikzcd}[cramped, row sep =2ex, column sep=4ex ,ampersand replacement=\&]
	Z\arrow[r,hook,"\phi"]\arrow[d,"\pi"] \& \P_S^2\\
	S
	\end{tikzcd}\right\} \Bigg/\!\sim
	\end{align*}
	where $\phi$ is a closed embedding, and $\pi$ is flat and its geometric fibres are conics, i.e, for any geometric point $\Spec L\rightarrow S$\footnote{and $L$ is (separably) algebraically closed.} the base change $Z_L$ is a conic in $\P_L^2$. We will show that this $F$ is not representable.
	
	For if it were representable, then there would exist a scheme $X$ such that $F\simeq h_X$. Moreover, for any $k$-scheme $S$, any element of $F(S)$ would then correspond to a morphism of schemes $S\rightarrow X$ (why?). Now, upto isomorphism there are only two conics in $\P_k^2$: the pair of lines $P$, and the smooth conic $Q$. This means that $X$ has only two $k$ points which we will also denote by $\{p,q\}$, respectively.
	
	Consider the family $Z$ over $\A_t^1$ described in Example \ref{example-family-nodal} (here the subscript $t$ is just to keep track of the variable used to define $\A^1$). This is a family of conics given by the equation $XY-tW^2$ in $\P_{\A_t^1}^2$. Its geometric fibres are given by,
	\begin{center}
		\begin{align*}
		Z_t = &\left\{
		\begin{aligned}
		& P,  && t=0\\
		& Q,  && t\neq 0
		\end{aligned}\right.
		\end{align*}
	\end{center}
	We have a map $f:\A_t^1\rightarrow X$ which pulls back the universal family\footnote{The \textit{universal family} is the element in $F(X)$ corresponding to the identity morphism $id: X\rightarrow X$.} to $Z$, i.e, the base change of the universal family to $\A_t^1$ is $Z$. Now, observe that for the closed point $q\in X$, $f^{-1}(q)$ is all non-zero $t$ in $\A_t^1$ (which is not a closed set!). Hence, such a map cannot be continuous. In particular, no such map exists. But clearly, $Z\in F(\A_t^1)$. Hence, $F$ is not representable.
\end{example}


\subsection{The Sheaf Condition.} Let $\mathcal{C}$ be a site, and $\{U_i \overset{f_i}{\to} U\}_{i\in I}$ be an element of $\text{Cov}(\mathcal{C})$. We have the fibre products for all $i,j$
\begin{center}
	\begin{tikzcd}
	U_i\times_U U_j\arrow[r,"\text{pr}_1"]\arrow[d,"\text{pr}_0"] & U_j\arrow[d,"f_j"]\\
	U_i\arrow[r,"f_i"] & U
	\end{tikzcd}
\end{center}

Let $\sF$ be a presheaf on $\mathcal{C}$. For the above covering we have a diagram,
\begin{equation}\label{equation-sheaf-condition}\marginnote{000V}
\begin{tikzcd}
\sF(U)\arrow[r] &\prod_{i\in I} \sF(U_i)\arrow[r,shift left,"\text{pr}^*_0"]\arrow[r,shift right,"\text{pr}^*_1"'] & \prod_{i,j\in I}\sF(U_i\times_U U_j)
\end{tikzcd}
\end{equation}

\begin{definition}
	\label{definition-sheaf}\marginnote{000W}
	Let $\mathcal{C}$ be a site, and let $\mathcal{F}$ be a presheaf of sets
	on $\mathcal{C}$. We say $\mathcal{F}$ is a {\it sheaf} if
	for every covering $\{U_i \to U\}_{i \in I} \in \text{Cov}(\mathcal{C})$,
	the diagram (\ref{equation-sheaf-condition}) represents the first arrow as the equalizer of $\text{pr}_0^*$
	and $\text{pr}_1^*$.	
\end{definition}

Loosely speaking this means that given sections $s_i \in \mathcal{F}(U_i)$
such that
$$
s_i|_{U_i \times_U U_j} = s_j|_{U_i \times_U U_j}
$$
in $\mathcal{F}(U_i \times_U U_j)$ for all $i, j \in I$
then there exists a unique $s \in \mathcal{F}(U)$ such
that $s_i = s|_{U_i}$\footnote{It is instructive to write out all the details in diagram (\ref{equation-sheaf-condition}) when the covering family has $3$ elements.}. Note that the above definition implies that $\sF(\emptyset)=\{*\}$ is a singleton.

\begin{example}
	Any scheme $X$ is sheaf on the big Zariski site $(\mathit{Sch}/S)_{\textit{Zar}}$ (why?).
\end{example}


\begin{definition}
	\label{definition-category-sheaves-sets}\marginnote{000X}
	The category {\it $\Sh(\mathcal{C})$}
	of sheaves of sets is the full subcategory of the category
	$\textit{PSh}(\mathcal{C})$ whose objects are the sheaves of sets.
\end{definition}


If the inclusion $\iota: \Sh(\mathcal{C})\hookrightarrow \textit{Psh}(\mathcal{C})$ admits a left adjoint, we call it the \textit{sheafification functor}. It may not exist even if fairy concrete situations. For example, it does not exist in the fpqc topology (see \cite[Theorem 5.5]{Waterhouse-fpqc-sheafification}). However, we have the following theorem due to Grothendieck.

\begin{theorem}[Grothendieck]\label{theorem-fpqc-representable}\marginnote{000Y}
	Every representable functor satisfies the sheaf property in the fpqc topology.
\end{theorem}

We always want representable objects to be sheaves, as the sheaf property expresses the correct categorical notion of ``gluing" things. And representable functors being sheaves means that morphisms glue. Moreover, the statements in Definition \ref{definition-locally-P-morphisms} can now be generalised to covering families of the various topologies on schemes.

\begin{definition}\label{definition-subcanonical-site}\marginnote{000Z}
	Let $\mathcal{C}$ be a category. We say that a topology $\tau$ on $\mathcal{C}$ is \textit{subcanonical} if every representable functor is a sheaf with respect to $\tau$. The \textit{canonical} topology is the finest on $\mathcal{C}$ such that every representable functor is a sheaf.
\end{definition}


\begin{example}[A non-subcanonical site]
	\label{example-non-subcanonical-site}\marginnote{0010}
	Consider the topology on $(\textit{Sch})$ with coverings given by $\{U_i \to U\}_{i \in I}$ which are jointly surjective families of flat morphisms. This ``wild" flat topology is not subcanonical.
	
	Take a smooth integral curve $U$ over an algebraically closed field $k$\footnote{For example, take $\P^1$.}. Let $K$ be its quotient field. For every closed point $p\in U(k)$, consider the spectrum of its local ring $V_p:=\Spec \sO_{U,p}$. Then $\{V_p \to U\}_{p \in U(k)}$ is a covering in this wild flat topology.
	
	Note that each of these local rings are discrete valuation rings with generic point $\Spec K$ and closed point $p$\footnote{Well, the maximal ideal in $\sO_{U,p}$ corresponding to $p$.}. Thus, $V_p\times_U V_q =V_p$ if $p=q$, and $\Spec K$ otherwise.
	
	We can now construct a scheme $X$ by gluing all the $V_p$'s along $\Spec K$\footnote{Note that this is just the construction in Example \ref{example-dvr-double-origin} iterated over all $p\in U(k)$}. The functor $\mathit{Hom}(-,X)$ is not a sheaf in the wild flat topology. In fact, we will show that it does not satisfy the sheaf condition for the covering $\{V_p \to U\}_{p \in U(k)}$. For this, consider the diagram
	\begin{center}
		\begin{tikzcd}
		\prod_{p\in U(k)} h_X(V_p)\arrow[r,shift left,"\text{pr}^*_0"]\arrow[r,shift right,"\text{pr}^*_1"'] & \prod_{p,q\in U(k)}h_X(V_p\times_U V_q)
		\end{tikzcd}
	\end{center}
	By construction of $X$, we have inclusions $i_p:V_p\hookrightarrow X$ for each $p\in U(k)$. This gives us an element $\{i_p\}_{p\in U(k)}$ of $\prod_{p\in U(k)} h_X(V_p)$ whose images in along $\text{pr}_0$ and $\text{pr}_1$ agree (why?). However, there is no morphism $U\rightarrow X$. This is because all subsets of $X$ formed by closed points are closed, but only finite set are closed in $U$.
	
\end{example}


To prove Theorem \ref{theorem-fpqc-representable}, we will use the following lemma.

\begin{lemma}
	\label{lemma-sheaf-property-fpqc}\marginnote{0011}
	Let $F$ be a presheaf on the category of schemes with values in sets. Then $F$ satisfies the sheaf property for the fpqc topology if and only
	if it satisfies
	\begin{enumerate}
		\item the sheaf property for every Zariski covering, and
		\item the sheaf property for $\{V \to U\}$
		with $V$, $U$ affine and $V \to U$ faithfully flat.
	\end{enumerate}
\end{lemma}
\begin{proof}
	Note that since every Zariki cover is an fpqc cover, the only if direction is obvious. So we only need to show the ($\Rightarrow$) direction.
	
	First observe that it is sufficient to prove this for fpqc covers $\{V\rightarrow U\}$ consisting of a single morphism (given an fpqc cover $\{U_i\rightarrow U\}_{i\in I}$, set $V:=\amalg_i U_i$). 
	
	The rest of the proof involves ``resolving" $F(U)$ in two different ways. First using the sheaf property for Zariski covers and second using the sheaf property the faithfully flat maps of affine. To do this, we will cover $U$ and $V$ by compatible affine opens.
	
	Take an fpqc cover $\{f: V\rightarrow U\}$. By definition, we have an open covering $V=\cup_i V_i$ such that each $V_i$ is quasi-compact and $f(V_i):=U_i$ is open and affine in $U$. Write $V_i$ as a union of finitely many open affines $V_{ia}$. Then we have the following diagram\footnote{or a ``resolution" of $F(U)$ in two different way.}
	\begin{center}
		\begin{tikzcd}
		F(U)\arrow[d]\arrow[r] &F(V)\arrow[d]\arrow[r,shift left]\arrow[r,shift right] & \prod_{i,j}F(V\times_U V)\arrow[d]\\
		\prod_{i} F(U_i)\arrow[d,shift left]\arrow[d,shift right]\arrow[r] &\prod_{i}\prod_a F(V_{ia})\arrow[d,shift left]\arrow[d,shift right]\arrow[r,shift left]\arrow[r,shift right] & \prod_i\prod_{a,b}F(V_{ia}\times_U V_{ib})\\
		\prod_{i,j I}F(U_i\cap U_j)\arrow[r] &\prod_i\prod_{a,b}F(V_{ia}\cap V_{ib})
		\end{tikzcd}
	\end{center}
	Since $F$ is a Zariski sheaf, the columns are equalizers. Further, note that since  $\{\amalg_a V_{ia}\rightarrow U_i\}$ is a faithfully flat ring map the diagram
	\begin{center}
		\begin{tikzcd}
		F(U_i)\arrow[r] &\prod_a F(V_{ia})\arrow[r,shift left]\arrow[r,shift right] & \prod_{a,b}F(V_{ia}\times_U V_{ib})
		\end{tikzcd}
	\end{center}
	is an equalizer. As equalizers commute with products, the second row is also an equalizer. Hemce, $F(U)\rightarrow F(V)$ is injective, and so the bottom row is also injective. Now, a diagram chase show that the top row is an equalizer.
\end{proof}

\begin{proof}[Proof of Theorem \ref{theorem-fpqc-representable}]
We only have to check condition (2) of Lemma \ref{lemma-sheaf-property-fpqc}. Further, we can write $X=\cup_i X_i$ as a union of affines. So, we are reduced to the case of affine schemes. But, for affine this follows easily from Lemma \ref{lemma-Amitsur}.
\end{proof}

\subsection{A Criteria for Representability.} Theorem \ref{theorem-fpqc-representable} implies that for a functor $F$ to be representable by a scheme, it must satisfy the sheaf property in the fpqc topology. Also, note that $(\mathit{Sch})$ is a full subcategory of $\mathit{Psh}(\mathit{Aff})$\footnote{This is straightforward to prove using the sheaf condition for the Zariski topology.}, a natural question is to identify when a functor $F$ lies in $\mathit{Sch}$. We will do this now.

Let $F,G$ be two functors on a category $\mathcal{C}$ with values in $\mathit{Sets}$. Note that by Lemma \ref{lemma-yoneda}, an element $\xi\in G(U)$ is the same as a morphism of functors $\xi: h_U\rightarrow G$.


\begin{definition}
	\label{definition-representable-map-presheaves}\marginnote{0012}
	Let $\mathcal{C}$ be a category.
	Let $F, G : \mathcal{C}^{opp} \to \textit{Sets}$
	be functors. We say a morphism $a : F \to G$ is
	{\it representable}, or that {\it $F$ is relatively representable
		over $G$}, if for every $U \in \Ob(\mathcal{C})$
	and any $\xi \in G(U)$ the functor
	$h_U \times_G F$ is representable\footnote{Fibre products exist for functors to $\mathit{Sets}$ because fibre products of sets exists.}.
\end{definition}

\begin{remark}[Important reality check]
	Any morphism $h_U\rightarrow h_V$ between representable functors is representable.
\end{remark}
We have the following lemma about representable morphisms.

\begin{lemma}
	\label{lemma-representable-diagonal}\marginnote{0013}
	Let $\mathcal{C}$ be a category.
	Let $F : \mathcal{C}^{opp} \to \textit{Sets}$ be a functor.
	Assume $\mathcal{C}$ has products of pairs of objects and fibre products.
	The following are equivalent:
	\begin{enumerate}
		\item the diagonal $\Delta : F \to F \times F$ is representable,
		\item for every $U$ in $\mathcal{C}$,
		and any $\xi \in F(U)$ the map $\xi : h_U \to F$ is representable,
		\item for every pair $U, V$ in $\mathcal{C}$
		and any $\xi \in F(U)$, $\xi' \in F(V)$ the fibre product
		$h_U \times_{\xi, F, \xi'} h_V$ is representable.
	\end{enumerate}
\end{lemma}
This is a straightforward exercise in definitions. The thing to keep in mind is the ``magic diagram"\footnote{as Ravi Vakil calls it.} (see \cite[Tag 0024]{stacks-project} for hints).

Representable morphisms of functors is a useful notion because any property of morphisms of schemes can be extended to representable morphisms.

\begin{definition}
	Let $\mathcal{P}$ be a property of morphisms of schemes that is stable under base change. Let $a: F\rightarrow G$ be a representable morphism of functors. We say that $a$ has the property $\mathcal{P}$, if for every scheme $U$ and every $\xi\in G(U)$ the morphism of schemes $a_U: h_U\times_G F\rightarrow h_U$ has $\mathcal{P}$. 
\end{definition}

Henceforth, we will confuse $U$ with its functor of points $h_U$.

\begin{example}[A morphism representable by affine schemes]
	\label{example-G-H-bundles}\marginnote{0019}
	Let $G$ be a finite group. Let $X$ be a scheme with a free and faithful action $G$. Define the functor $X_G$ which classifies \textit{principal $G$-bundles with an equivariant map to $X$}, as follows
	\begin{align*}
	X_G: (\mathit{Aff})^{opp} & \rightarrow \mathit{Sets}\\
	V & \mapsto \left\{
	\begin{tikzcd}[cramped, row sep =3.5ex, column sep=4ex ,ampersand replacement=\&]
	P\arrow[r,"\phi"]\arrow[d,"p"] \& X\\
	V
	\end{tikzcd}\right\} \Bigg/\!\sim
	\end{align*}
	where $p: P\rightarrow V$ is a principal $G$-bundle and $\phi$ is a $G$-equivariant map. We will denote this entire data by the map $p$, and say that $p\in X_G(V)$. Note that if the quotient $X/G$ exists (as a scheme), then the $X_G$ is precisely represented by $X/G$\footnote{$X/G$ may not be a scheme (see Remark \ref{remark-algebraic-spaces}).}.
	
	If $H$ is a subgroup of $G$, we also have an action of $H$ of $X$. This gives us a functor $X_H$ which is defined similarly. There is a natural map $\alpha: X_H\rightarrow X_G$ which send any principal $H$-bundle $q: Q\rightarrow V$ to the principal $G$-bundle $Q\times_H G\rightarrow V $. The map $\alpha$ is affine\footnote{if $H$ is normal, it is, in fact, a $G/H$-torsor.}. For any affine $V$, quotients by finite groups exist as affine scheme\footnote{Take $\Spec R^G$, the $G$-invariant subring of $R$.}. We will show that the base change $X_H\times_{X_G} V$ is representable by $(P\times_H G)/G$, where $P$ is the $G$-bundle associated to the map $p:V\rightarrow X_G$.
	
	Let us observe what the data of a $T$-point of $X_H\times_{X_G} V$ is. It is the data of a pair: an $H$-bundle $Q$ and a $G$-bundle $P':=P\times_V X$ on $T$ (with $H$ and $G$-equivariant maps to $X$, respectively), such that the $\alpha(Q)=P'$. Heuristically speaking, we need to construct a space which becomes a principal bundle in two different ways.
	
	The key idea is to observe that for a principal $G$-bundle $p\in X_G(V)$, the product $P\times G$ admits both an $H$-action and a $G$-action which commute with each other. The $G$-action is given by multiplication on the right $(p,g,g')\overset{\nu_G}{\mapsto} (p,gg')$. While the $H$-action is given by the map $(p,g,h)\overset{\nu_H}{\mapsto} (ph,h^{-1}g)$. We write the quotient $(P\times G)/H$ as $P\times_H G$.
	
	Now, we have diagram
	\begin{center}
		\begin{tikzcd}
		P\times G\arrow[r,"pr_1"]\arrow[d,"p"] & P\\
		(P\times_H G)
		\end{tikzcd}
	\end{center}
	Here, $pr_1$ is the projection onto $P$. Note that $pr_1$ is $H$-equivariant, and $p$ is a $G$-equivariant map. Thus, we get the following cartesian square,
	\begin{center}
		\begin{tikzcd}
		P\times G\arrow[r,"pr_1"]\arrow[d,"p"] & P\arrow[d]\\
		P\times_H G\arrow[r] & P/H
		\end{tikzcd}
	\end{center}
	which shows that $(P\times_H G)/G\simeq P/H$. In the above square, the horizontal maps are principal $G$-bundle, whereas the vertical maps are principal $H$-bundle.
	
	We also have a $G$-equivariant map $\phi: P\rightarrow X$. This gives us a $G$-equivariant map $P\times_H G\rightarrow X$ given by $(ph,h^{-1}g)\mapsto \phi(ph)$. This shows that $p:P\times_H G\rightarrow P/H$ gives an element of $X_G$. Similarly, $q: P\rightarrow P/H$ gives an element of $X_H$ .
	
	Now, note that giving a map $T\rightarrow (P\times_H G)/G \simeq P/H$ is the same as giving a $G$-bundle $p_T: T\times_{P/H}P\times_H G \rightarrow T$, and an $H$-bundle $q_T: T\times_{P/H}P\rightarrow T$\footnote{Just base-change $p$ and $q$, respectively.}. Now observe that $\alpha (q_T)$ is the $G$-bundle $T\times_{P/H}P\times_H G\rightarrow T$ which is $p_T$. It is straightforward to check that this gives the appropriate equivariant maps to $X$.
\end{example}

The above observation about $(G,H)$-bundles is canonical and applies to schemes in general. This is very useful when dealing with problems about reduction of structure group. So, we restate it as a lemma.

\begin{lemma}
	Let $P\rightarrow V$ be a principal $G$-bundle. Let $H\subset G$ a subgroup of $G$. Then, $(P\times_H G)/G \simeq P/H$. Further if $H$ is normal, then the canonical map $P/H\rightarrow P/G$ is a $G/H$-bundle.
\end{lemma}
\begin{proof}
	Follows from the above discussion.
\end{proof}

\begin{example}[A representable diagonal]
	\label{example-schematic-diagonal}\marginnote{001A}
	Let $\mathit{FSch/k}$ be the category of finite type schemes over an algebraically closed field $k$. Let $F$ be the functor on $\mathit{FSch/k}$ defined in Example \ref{example-functor-of-conics}. The diagonal of this functor $\Delta: F\rightarrow F\times_k F$ is representable by $k$-schemes! I will add a proof soon. These is essentially because we have flat families. Moduli problems dealing with non-flat families are almost impossible to work with.
	
	By Lemma \ref{lemma-representable-diagonal}, it is sufficient to prove that for any $U,V$ and any morphisms $\xi:U\rightarrow F$, $\xi':V\rightarrow F$, The fibre product $U\times_{\xi,F,\xi'} V$ is representable. By definition, $\xi$ and $\xi'$ are closed subschemes $Z\subset \P_U^2$ and $Z'\subset \P_V^2$ which are flat over $U$ and $V$, respectively. Base-changing $Z$ and $Z'$ along the projection maps $U\times_k V\rightarrow U$ and $U\times_k V\rightarrow V$, we have two closed subschemes $Z\times_k V$ and $Z'\times_k U$ of $\P_{U\times_k V}^2$ which are flat over $U\times_k V$. Then, then following lemma implies that $U\times_{\xi,F,\xi'} V$ is representable by a closed subscheme of $U\times_k V$.
	
	%Now, one can prove that there exist a closed subscheme $W$ of $U\times_k V$ on which $Z\times_k V$ and $Z'\times_k U$ become equal\footnote{This subcheme can also be empty!}, i.e, $Z\times_k V\times_{U\times_k V} W$ and $Z'\times_k U\times_{U\times_k V} W$ become equal in $\P_W^2$. This require a certain lemma which we will prove later. We express this fact by saying that the condition for two closed subscheme of $\P^2$ flat over the base to become equal is a closed condition on the base.
	
	%We claim that this $W$ represents $U\times_{\xi,F,\xi'} V$. Clearly, we have a map $W\rightarrow U\times_{\xi,F,\xi'} V$ given by $(\xi_W,\xi'_W)$.
	
\begin{lemma}
	\label{lemma-equalising-flat-subschemes}\marginnote{0014}
	Let $f: X\rightarrow S$ be a flat projective morphism of Noetherian schemes. Let $D$ and $E$ be two closed subschemes of $X$ with $E$ flat over $S$. Then there exists a closed subscheme $S'$ of $S$ such that for any morphism $T\rightarrow S$, the fibre product $T\times_S E\subseteq T\times_S X$ is contained in $T\times_S X$ if and only if the morphism $T\rightarrow S$ factors through $S'$.
\end{lemma}

Since $Z$ and $Z'$ are both flat families, we get the required result\footnote{proving such a statement for non-flat families is quite hard, and is not true, in general.}. Ultimately, the above lemma is a statement about coherent sheaves on $X$. We will surely discuss a proof at some point in our seminar. You can also find a proof in \cite[Lemma B.6.2]{ACV03}.

\end{example}


\begin{definition}
	\label{definition-separated-scheme-functor}\marginnote{0015}
	Let $F$ be a functor on the category of affine schemes $\mathit{Aff}$. We say that $F$ is a \textit{separated scheme} if the following conditions are satisfied:
	\begin{enumerate}
		\item $F$ is a sheaf on $(\mathit{Aff})_{\textit{Zar}}$.
		\item The diagonal $\Delta: F\rightarrow F\times F$ is a representable closed immersion.
		\item There exist affine schemes $\{U_i\}_{i\in I}$ and morphisms $\xi_i: U_i\rightarrow F$ which are representable open immersions, such that the map from the disjoint union $\amalg_i U_i\rightarrow F$ is an epimorphism of sheaves in the Zariski topology.
	\end{enumerate}
\end{definition}

We can tweak Definition \ref{definition-representable-map-presheaves} to the following: We will say $a: F\rightarrow G$ is \textit{representable by separated schemes} if the fibre product $h_U\times_G F$ is a separated scheme in the sense of Definition \ref{definition-separated-scheme-functor}.

\begin{definition}
	\label{definition-scheme-functor}\marginnote{0016}
		Let $F$ be a functor on the category of affine schemes $\mathit{Aff}$. We say that $F$ is a \textit{scheme} if the following conditions are satisfied:
	\begin{enumerate}
		\item $F$ is a sheaf on $(\mathit{Aff})_{\textit{Zar}}$.
		\item The diagonal $\Delta: F\rightarrow F\times F$ is a representable by separated schemes.
		\item There exist affine schemes $\{U_i\}_{i\in I}$ and morphisms $\xi_i: U_i\rightarrow F$ which are representable open immersions, such that the map from the disjoint union $\amalg_i U_i\rightarrow F$ is an epimorphisms of sheaves in the Zariski topology.
	\end{enumerate}
\end{definition}

Be sure to check this gives this agrees with the usual description of a scheme. (Hint: since the $U_i\times_F U_j$'s are schemes, you can glue the $U_i$ along these fibre products to construct a scheme $X$ and then show that it is isomorphic to the functor $F$.)

\begin{remark}
	\label{remark-algebraic-spaces}
	It is not possible to directly define the category of schemes without defining separated schemes first. The reason is that for a scheme the intersection of affine opens need not be an affine. This kind of functorial description was first thought of by Artin (and Grothendieck) to define quotients by \'{e}tale equivalence relations\footnote{For example, a $\Z/2$-action on a proper threefold. The details will show up in detail at some point in our seminar.} that do not exist as schemes. These are what are called \textit{algebraic spaces} (replace Zariski with \'{e}tale in Definition \ref{definition-separated-scheme-functor} above and you will have defined an (separated) algebraic space). You will find mentions of such a construction for schemes in any source discussing algebraic spaces. However, the first place where I found a complete construction as above was in Martin Olsson's book (see \cite{olsson16})\footnote{Definition \ref{definition-scheme-functor} is the same as the one given in \cite{olsson16}. But, one could also use schemes with affine diagonal instead of separated scheme for this construction.}.
\end{remark}


\newpage
\bibliography{Mybib.bib}
\bibliographystyle{alpha}


\end{document}



